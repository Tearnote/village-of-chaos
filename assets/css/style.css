/* #region CSS reset */
/* Adapted from https://www.joshwcomeau.com/css/custom-css-reset/ */

*,
*::before,
*::after {
	box-sizing: border-box;
	margin: 0;
	overflow-wrap: break-word;
}

html,
body {
	height: 100%;
}

body {
	line-height: 1.5;
}

img,
picture,
video,
canvas,
svg {
	display: block;
	max-width: 100%;
}

input,
button,
textarea,
select {
	font: inherit;
}

a:visited {
	color: inherit;
}

/* #endregion */

/* #region Site style and general layout */

body {
	display: flex;
	/* Placeholder */
	font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS",
		sans-serif;

	/* Color palette */
	--primary-color: #768c38;
	--primary-highlight-color: #b3c55a;
	--secondary-color: #349097;
	--secondary-highlight-color: #4dd7e1;
	--active-color: #e7fffc;
	--inactive-color: #a8bab8;

	/* Element visibility variables, controlled by JS */
	--income-display: none;
	--stone-display: none;
	--craft-speed-display: none;
	--research-speed-display: none;
	--assign-display: none;
	--research-display: none;
	--chaos-display: none;
	--mentor-display: none;
	--manager-display: none;
	--fisherman-display: none;
	--miner-display: none;
	--blacksmith-display: none;
	--professor-display: none;

	/* Controls sizing of the two main page sections */
	--main-size: min(100vw, 100vh);
}

@media (orientation: landscape) {
	body {
		flex-flow: row;
	}
}

@media (orientation: portrait) {
	body {
		flex-flow: column;
	}
}

#main {
	width: var(--main-size);
	height: var(--main-size);
	display: flex;
	flex-flow: column;
	justify-content: space-between;
}

#side {
	display: flex;
	justify-content: space-between;
	background-color: white;
}

@media (orientation: landscape) {
	#side {
		flex-direction: column;
		min-width: 24rem;
		width: calc(100vw - var(--main-size));
		height: 100%;
	}
}

@media (orientation: portrait) {
	#side {
		flex-direction: row;
		width: 100%;
		min-height: 24rem;
		height: calc(100vh - var(--main-size));
	}
}

button {
	min-width: 1.5rem;
	background-color: var(--active-color);
	border: 1px solid black;
	cursor: pointer;
}

/* #endregion */

/* #region Game world */

#world {
	/*
	We need to calculate scale from JS,
	because calc() doesn't support floats
	*/
	--scale: 1;
	position: absolute;
	width: 640px;
	height: 640px;
	/*
	Because scale() zooms in from the center of the element,
	we need to push the element away from the edge to make sure
	that it stays in the same place after the scaling
	*/
	left: calc(320px * (var(--scale) - 1));
	top: calc(320px * (var(--scale) - 1));
	z-index: -1;
	image-rendering: pixelated;
	transform: scale(var(--scale));
}

#world > img {
	position: absolute;
	object-fit: contain;
}

#terrain-img {
	left: 0;
	top: 0;
}

#tent-img {
	display: var(--assign-display);
	left: 320px;
	top: 361px;
}

#pier-img {
	display: var(--fisherman-display);
	left: 112px;
	top: 304px;
}

#quarry-img {
	display: var(--miner-display);
	left: 337px;
	top: 130px;
}

#smithy-img {
	display: var(--blacksmith-display);
	left: 261px;
	top: 288px;
}

#academy-img {
	display: var(--professor-display);
	left: 138px;
	top: 377px;
}

/* #endregion */

/* #region Header and warehouse */

header {
	flex: 0 0 auto;
	width: 100%;
	text-align: right;
	padding: 0.4rem 0.75rem 0.8rem;
	background-color: var(--secondary-color);
}

h1 {
	padding-bottom: 0.2rem;
}

#warehouse {
	flex: 0 0 auto;
	display: flex;
	flex-flow: row;
	align-items: center;
	justify-content: stretch;
	padding: 0.6rem 0.8rem;
	background-color: var(--secondary-highlight-color);
}

#warehouse > div {
	flex: 1 0 0;
}

.resource-name {
	display: inline-block;
	text-align: right;
	min-width: 3rem;
}

.resource-amount {
	display: inline-block;
	min-width: 3rem;
}

.multiplier-name {
	display: inline-block;
	text-align: right;
	min-width: 7.5rem;
}

.income {
	display: var(--income-display);
}

.stone {
	display: var(--stone-display);
}

.craft-speed {
	display: var(--craft-speed-display);
}

.research-speed {
	display: var(--research-speed-display);
}

#reset {
	color: red;
}

/* #endregion */

/* #region Game control section */

#controls {
	flex: 1 0 0;
}

#assign {
	background-color: var(--primary-highlight-color);
}

#craft {
	background-color: var(--primary-color);
}

/* #endregion */

/* #region Assign tab */

#assign {
	padding: 0.8rem 1.0rem;
}

.job {
	display: flex;
	flex-flow: row wrap;
	align-items: baseline;
	padding: 0.4rem 0;
}

.job > h3,
.job-details {
	width: 50%;
}

.assignment {
	padding: 0.2rem 0.8rem;
	display: flex;
	flex-flow: column;
	align-items: center;
}

.assignment > p {
	text-align: center;
}

.job-level,
.job-count {
	font-weight: 700;
}

/* #endregion */

/* #region Gathering */

#gathering {
	width: fit-content;
	align-self: center;
	display: flex;
	justify-content: center;
	flex-flow: column;
	margin: 2rem;
}

#gathering > button {
	margin: 0.4rem;
	padding: 0.2rem 0.5rem;
}

/* #endregion */

/* #region Log */

#log {
	min-width: 20rem;
	width: 40%;
	min-height: 10rem;
	height: 20%;
	display: flex;
	flex-flow: column-reverse; /* Keeps container scrolled down */
	overflow-y: scroll;
	margin: 0.5rem;
	padding: 0.5rem;
	font-family: "Courier New", Courier, monospace;
	font-size: 0.8rem;
	background-color: rgba(255, 255, 255, 0.6);
	backdrop-filter: blur(1rem);
}

#log > p:not(:last-child) {
	padding-top: 0.2rem;
	border-top: 1px solid rgba(0, 0, 0, 0.12);
	margin-top: 0.2rem;
}

.info {
	color: blue;
}

.story {
	color: darkgreen;
}

.event {
	color: orangered;
}

/* #endregion */

/* #region Upgrades */

.upgrade {
	position: relative;
	margin: 0.5rem;
	border: 1px solid black;
	padding: 0.5rem 1rem;
	background-color: var(--active-color);
	cursor: pointer;
	user-select: none;
	--progress: 0%;
}

.upgrade.inactive {
	background-color: var(--inactive-color);
}

.upgrade::after {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: 0;
	width: var(--progress);
	height: 100%;
}

#craft > .upgrade::after {
	background-color: rgba(152, 255, 160, 0.4);
}

#research > .upgrade::after {
	background-color: rgba(152, 154, 255, 0.4);
}

/* #endregion */

/* #region Tutorial pop-up */

#popup-shroud {
	display: none; /* Controlled by JS */
	position: fixed;
	width: 100%;
	height: 100%;
	background-color: rgba(0, 0, 0, 0.6);
	user-select: none; /* Prevent accidental select by spamming the shroud */
}

#popup {
	position: fixed;
	top: 0; /* Controlled by JS */
	left: 0; /* Controlled by JS */
	display: flex;
	flex-flow: column;
	align-items: center;
	text-align: justify;
	margin: 0.2rem;
	border: paleturquoise solid 4px;
	padding: 0.8rem 1rem;
	background-color: white;
	user-select: text; /* Re-enable inherited select on the pop-up directly */
}

#popup-text {
	max-width: 24rem;
	margin-bottom: 0.5rem;
}

#popup-dismiss {
	width: fit-content;
}

/* #endregion */
